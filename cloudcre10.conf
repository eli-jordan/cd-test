
staging = {
  id = tapad-paas-eli-operator-test
  branch = cc10-staging
  dir = ./environments/staging
  trigger {
    type = nexus
    group = "com.tapad.eli"
    artifact = "eli-test"
    modify {
      file = ./environments/version.conf
      path = "bundle"
    }
    labels = [ "cloudcre10:bundle-upgrade" ]
  }

  requirements = [
    { type = plan, trigger = auto }
//    { type = pr-approved }
//    { type = mergable }
    { type = deploy, trigger = auto }
    {
      type = jenkins,
      trigger = auto
      name = test
      job = Testing/eli-programmatic-test

      parameters {
        ELI_TEST_PARAM_1 = "test-param1"
        ELI_TEST_PARAM_2 = "test-param2"
      }
    }
  ]
}

production-base = {
  branch = cc10-production
  trigger {
    type = merge-into
    branch = cc10-staging
    labels = [ "cloudcre10:production-promotion" ]
  }

  requirements = [
    { type = plan, trigger = auto }
    { type = deploy, trigger = comment }
  ]
}

production = ${production-base}
production = {
  id = tapad-paas-atlantis-poc-prd
  dir = ./environments/production
}

production2 = ${production-base}
production2 = {
  id = tapad-paas-atlantis-poc-prd2
  dir = ./environments/production2
}

environments = [
  ${staging}
  ${production}
  ${production2}
]